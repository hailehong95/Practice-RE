#include <Windows.h>
#pragma comment (linker, "/SUBSYSTEM:windows /ENTRY:mainCRTStartup")

unsigned char buf[] =
"\x48\x83\xec\x28\x48\x83\xe4\xf0\x48\x8d\x15\x66\x00\x00\x00"
"\x48\x8d\x0d\x52\x00\x00\x00\xe8\x9e\x00\x00\x00\x4c\x8b\xf8"
"\x48\x8d\x0d\x5d\x00\x00\x00\xff\xd0\x48\x8d\x15\x5f\x00\x00"
"\x00\x48\x8d\x0d\x4d\x00\x00\x00\xe8\x7f\x00\x00\x00\x4d\x33"
"\xc9\x4c\x8d\x05\x61\x00\x00\x00\x48\x8d\x15\x4e\x00\x00\x00"
"\x48\x33\xc9\xff\xd0\x48\x8d\x15\x56\x00\x00\x00\x48\x8d\x0d"
"\x0a\x00\x00\x00\xe8\x56\x00\x00\x00\x48\x33\xc9\xff\xd0\x4b"
"\x45\x52\x4e\x45\x4c\x33\x32\x2e\x44\x4c\x4c\x00\x4c\x6f\x61"
"\x64\x4c\x69\x62\x72\x61\x72\x79\x41\x00\x55\x53\x45\x52\x33"
"\x32\x2e\x44\x4c\x4c\x00\x4d\x65\x73\x73\x61\x67\x65\x42\x6f"
"\x78\x41\x00\x48\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64\x00"
"\x4d\x65\x73\x73\x61\x67\x65\x00\x45\x78\x69\x74\x50\x72\x6f"
"\x63\x65\x73\x73\x00\x48\x83\xec\x28\x65\x4c\x8b\x04\x25\x60"
"\x00\x00\x00\x4d\x8b\x40\x18\x4d\x8d\x60\x10\x4d\x8b\x04\x24"
"\xfc\x49\x8b\x78\x60\x48\x8b\xf1\xac\x84\xc0\x74\x26\x8a\x27"
"\x80\xfc\x61\x7c\x03\x80\xec\x20\x3a\xe0\x75\x08\x48\xff\xc7"
"\x48\xff\xc7\xeb\xe5\x4d\x8b\x00\x4d\x3b\xc4\x75\xd6\x48\x33"
"\xc0\xe9\xa7\x00\x00\x00\x49\x8b\x58\x30\x44\x8b\x4b\x3c\x4c"
"\x03\xcb\x49\x81\xc1\x88\x00\x00\x00\x45\x8b\x29\x4d\x85\xed"
"\x75\x08\x48\x33\xc0\xe9\x85\x00\x00\x00\x4e\x8d\x04\x2b\x45"
"\x8b\x71\x04\x4d\x03\xf5\x41\x8b\x48\x18\x45\x8b\x50\x20\x4c"
"\x03\xd3\xff\xc9\x4d\x8d\x0c\x8a\x41\x8b\x39\x48\x03\xfb\x48"
"\x8b\xf2\xa6\x75\x08\x8a\x06\x84\xc0\x74\x09\xeb\xf5\xe2\xe6"
"\x48\x33\xc0\xeb\x4e\x45\x8b\x48\x24\x4c\x03\xcb\x66\x41\x8b"
"\x0c\x49\x45\x8b\x48\x1c\x4c\x03\xcb\x41\x8b\x04\x89\x49\x3b"
"\xc5\x7c\x2f\x49\x3b\xc6\x73\x2a\x48\x8d\x34\x18\x48\x8d\x7c"
"\x24\x30\x4c\x8b\xe7\xa4\x80\x3e\x2e\x75\xfa\xa4\xc7\x07\x44"
"\x4c\x4c\x00\x49\x8b\xcc\x41\xff\xd7\x49\x8b\xcc\x48\x8b\xd6"
"\xe9\x14\xff\xff\xff\x48\x03\xc3\x48\x83\xc4\x28\xc3";


int main(int argc, char const* argv[])
{
	DWORD flOldProtect;
	VirtualProtect(buf, sizeof(buf), PAGE_EXECUTE_READWRITE, &flOldProtect);
	(*(void (*)()) & buf)();
	return 0;
}

/*
** Ref:
** - Windows x64 MessageBox Shellcode: https://gist.github.com/kkent030315/b508e56a5cb0e3577908484fa4978f12
** More:
** - Win32 Shellcode - Spawn MessageBox: https://blackcloud.me/Win32-shellcode-3/
** - Win32 Shellcode - Spawn the Calc: https://blackcloud.me/Win32-shellcode-2/
*/